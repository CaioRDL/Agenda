import random
AGENDA = {} #Váriavel maiscula para declarar como global


def mostrarContato():
    for ID in AGENDA:
        buscarContato(ID)
        print("----------------------")

def buscarContato(ID):
    try:
        print("ID", ID)
        print("Nome", AGENDA[ID]['nome'])
        print("Setor", AGENDA[ID]['setor'])
        print("Ramal", AGENDA[ID]['ramal'])
        print("Tempo", AGENDA[ID]['tempo'])
        print("IP", AGENDA[ID]['ipMaquina'])
        print("Descrição", AGENDA[ID]['descProblema'])
        print("Data", AGENDA[ID]['data'])
    except KeyError as error:
        print("Contato inexistente")
        print(error)



def inserirContato(nome, ramal,setor,tempo,ipMaquina,descProblema,data,ID):

        AGENDA[ID] = {
            'nome': nome,
            'ramal': ramal,
            'setor': setor,
            'tempo': tempo,
            'ipMaquina': ipMaquina,
            'descProblema': descProblema,
            'data': data,
            'ID':ID
        }


def main():
    print("1 - Mostrar Contato ")
    print("2 - Buscar Contato ")
    print("3 - Inserir Contato ")
    print("4 - Exportar Relatório ")
    print("0 - Para fechar o Programa")

while True:
    main()

    opcao = input("Digite uma opcao " )

    if(opcao == "1"):
        mostrarContato()

    elif(opcao == "2"):
        try:
            ID = input("Digite o nome do usuário: ")
            buscarContato(ID)
        except Exception as error:
            print("Erro ao consultar o usuário")
            print(error)


    elif(opcao == "3"):
        try:
            nome = input("Digite o nome do usuário: ")
            ramal = input("Ramal do usuário: ")
            setor = input("Setor: ")
            tempo = input("Tempo estimado em minutos: ")
            ipMaquina = input("IP da máquina: ")
            descProblema = input("Descrição do problema: ")
            data = input("Data: ")
            ID = random.randint(1,100)
            inserirContato(nome,ramal,setor,tempo,ipMaquina,descProblema,data,ID)

        except Exception as error:
            print("Erro ao inserir o usuário")
            print(error)


    elif(opcao == "4"):
        try:

            with open("relatorio.csv", "a") as arquivo:
                for contato in AGENDA:
                    ramal = AGENDA[contato]['ramal']
                    setor = AGENDA[contato]['setor']
                    tempo = AGENDA[contato]['tempo']
                    ipMaquina = AGENDA[contato]['ipMaquina']
                    descProblema = AGENDA[contato]['descProblema']
                    data = AGENDA[contato]['data']
                    arquivo.write("{},{},{},{},{},{}\n".format(contato,ramal,setor,tempo,ipMaquina,descProblema,data))
        except Exception as error:
            print("Erro ao exportar os contatos")
            print(error)

    elif(opcao == "0"):
        print("Fechando o programa")
        break

    else:
        ("Opção inexistente")

